---
layout: drafts
title: 记录一下,在家里部署flask, 使外网访问
date: 2019-02-23 22:41:16
tags:
---

直入正题, 如果需要将家里的服务提供给外网访问, 先决条件是网络供应商提供给你的网络ip是独立的公网ip.  

打开百度, 搜关键字"ip地址", 查询到你当前网络的ip地址, 然后复制, 打开终端, ping 你查到的ip地址, 如果一直timeout, 那么几乎99%说明这并不是一个独立的公网ip.

今天我也是遇到了这种情况, 发现ping ip 一直timeout, 开始还以为是直接用电信光猫自动拨号上网的原因, 后来改用路由器账号密码拨号上网, 还是一样. 

在路由里显示的因特网ip是以 100.xxx 开头的, 而且路由里显示的因特网ip还跟百度查到的地址不一样, 拿路由显示的因特网ip到百度一查, 显示的是保留地址, 无奈, 只能找找给我们家装网络的电信小师傅了.\
开门见山, 我就直接跟电信小师傅在微信上问了两句能不能给我独立的公网ip呢, 电信小哥直接"好, 我帮你改", 2分钟, 微信跟我说改好了, 我重启了一下路由, 果然, 路由显示的因特网ip地址 跟 百度查到的地址是一致的, ping一下, 通了.

再次感谢电信小师傅!

然后就开始折腾了, (下面并不是部署项目的最佳方法, 请勿模仿, 部署flask的正确方法还在摸索, 有点门路了, 一定再次记录下来) 在nas上用docker装了Ubuntu, 在Ubuntu上装 python 装 pip 装 pipenv 装 mariaDB, 中间经历不少波折, 但大都可靠百度解决, 过关斩将, 终于在docker中的Ubuntu跑了起来, 然后 切记 docker 本地端口/容器端口 设置 类似于路由的端口映射. 跟flask中app_run的参数有很大的关系. \
flask 项目里面的代码, app_run(host='0.0.0.0', port=docker设置的本地端口), 而路由设置的映射内部端口, 就是docker设置的容器端口.


